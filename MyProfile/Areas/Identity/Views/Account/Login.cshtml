@{
    ViewData["Title"] = "Регистрация аккаунта";
    Layout = "LayoutBlank";
}

@section Styles {
    <!-- Page -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    <link rel="stylesheet" href="~/vendor/css/pages/authentication.css">
    <style>
        .error {
            border: 1px solid var(--red) !important;
        }
    </style>
}
@section Scripts {
    <script src="~/vendor/libs/vue/dist/vue.js"></script>
    <script src="~/js/areas/pages/login.js"></script>
}

<!--
=================================================================
**************************** CONTENT ****************************
-->

<div class="authentication-wrapper authentication-3" id="login-vue">
    <div class="authentication-inner">

        <!-- Side container -->
        <!-- Do not display the container on extra small, small and medium screens -->
        <div class="d-none d-lg-flex col-lg-8 align-items-center ui-bg-cover ui-bg-overlay-container p-5" style="background-image: url('/img/bg/21.jpg');">
            <div class="ui-bg-overlay bg-dark opacity-50"></div>

            <!-- Text -->
            <div class="w-100 text-white px-5">
                <h1 class="display-2 font-weight-bolder mb-4">JOIN OUR<br>COMMUNITY</h1>
                <div class="text-large font-weight-light">
                    Lorem ipsum dolor sit amet, consectetur adipiscing elit. Vestibulum vehicula ex eu gravida faucibus. Suspendisse viverra pharetra purus. Proin fringilla ac lorem at sagittis. Proin tincidunt dui et nunc ultricies dignissim.
                </div>
            </div>
        </div>
        <div class="d-flex col-lg-4 align-items-center bg-white p-5">
            <div class="d-flex col-sm-7 col-md-5 col-lg-12 px-0 px-xl-4 mx-auto">
                <div class="w-100">

                    <!-- Logo -->
                    <div class="d-flex justify-content-center align-items-center">
                        <div class="ui-w-60">
                            <div class="w-100 position-relative" style="padding-bottom: 54%">
                                <svg class="w-100 h-100 position-absolute" viewBox="0 0 148 80" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><linearGradient id="a" x1="46.49" x2="62.46" y1="53.39" y2="48.2" gradientUnits="userSpaceOnUse"><stop stop-opacity=".25" offset="0"></stop><stop stop-opacity=".1" offset=".3"></stop><stop stop-opacity="0" offset=".9"></stop></linearGradient><linearGradient id="e" x1="76.9" x2="92.64" y1="26.38" y2="31.49" xlink:href="#a"></linearGradient><linearGradient id="d" x1="107.12" x2="122.74" y1="53.41" y2="48.33" xlink:href="#a"></linearGradient></defs><path class="fill-primary" transform="translate(-.1)" d="M121.36,0,104.42,45.08,88.71,3.28A5.09,5.09,0,0,0,83.93,0H64.27A5.09,5.09,0,0,0,59.5,3.28L43.79,45.08,26.85,0H.1L29.43,76.74A5.09,5.09,0,0,0,34.19,80H53.39a5.09,5.09,0,0,0,4.77-3.26L74.1,35l16,41.74A5.09,5.09,0,0,0,94.82,80h18.95a5.09,5.09,0,0,0,4.76-3.24L148.1,0Z"></path><path transform="translate(-.1)" d="M52.19,22.73l-8.4,22.35L56.51,78.94a5,5,0,0,0,1.64-2.19l7.34-19.2Z" fill="url(#a)"></path><path transform="translate(-.1)" d="M95.73,22l-7-18.69a5,5,0,0,0-1.64-2.21L74.1,35l8.33,21.79Z" fill="url(#e)"></path><path transform="translate(-.1)" d="M112.73,23l-8.31,22.12,12.66,33.7a5,5,0,0,0,1.45-2l7.3-18.93Z" fill="url(#d)"></path></svg>
                            </div>
                        </div>
                    </div>
                    <!-- / Logo -->

                    <h4 class="text-center text-lighter font-weight-normal mt-4 mb-0" v-show="login.isShow">Авторизация</h4>
                    <h4 class="text-center text-lighter font-weight-normal mt-4 mb-0" v-show="registration.isShow">Создание аккаунта</h4>
                    <h4 class="text-center text-lighter font-weight-normal mt-4 mb-0" v-show="recoveryPassword.isShow || recoveryPassword2.isShow">Восстановление пароля</h4>
                    <h4 class="text-center text-lighter font-weight-normal mt-4 mb-0" v-show="enterCode.isShow">Ввод кода</h4>

                    <!-- login -->
                    <form class="my-5 login" v-show="login.isShow">
                        <div class="form-group">
                            <label class="form-label">Почта</label>
                            <input type="text" class="form-control" v-model="email" tabindex="1"
                                   v-bind:class="isValidEmail ? '' : 'is-invalid'">
                            <small class="invalid-feedback">Пожалуйста, введите корректный адрес электронной почты.</small>
                        </div>
                        <div class="form-group">
                            <label class="form-label d-flex justify-content-between align-items-end">
                                <div>Пароль</div>
                                <a href="javascript:void(0)" class="d-block small" v-on:click="changeView(login.id, recoveryPassword.id)">Забыли пароль?</a>
                            </label>
                            <div class="input-group">
                                <input type="password" class="form-control" v-model="password" tabindex="2" name="password"
                                       v-bind:class="isValidPassword ? '' : 'is-invalid'">
                                <span class="input-group-append">
                                    <button class="btn btn-outline-secondary" type="button" title="Показать пароль" style="border-radius: 0px 4px 4px 0px;"
                                            v-on:click="isHiddenPassword = !isHiddenPassword">
                                        <i class="fas fa-eye" v-show="isHiddenPassword"></i>
                                        <i class="fas fa-eye-slash" v-show="isHiddenPassword == false"></i>
                                    </button>
                                </span>
                                <small class="invalid-feedback">Пожалуйста, введите корректный пароль.</small>
                            </div>
                        </div>
                        <div class="d-flex justify-content-between align-items-center m-0">
                            <label class="custom-control custom-checkbox m-0">
                                <input type="checkbox" class="custom-control-input">
                                <span class="custom-control-label">Запомнить меня</span>
                            </label>
                            <button class="btn btn-primary" type="button" tabindex="3"
                                    v-bind:disabled="isSaving"
                                    v-on:click="loginSave">
                                <span class="spinner-border" role="status" aria-hidden="true" v-show="isSaving"></span>
                                Войти
                            </button>
                        </div>
                        <div class="text-center text-muted mt-4">
                            Если у вас еще нет аккаунта <a href="javascript:void(0)" v-on:click="changeView(login.id,registration.id)">Зарегистрироваться</a>
                        </div>
                    </form>
                    <!-- / login -->
                    <!-- registration -->
                    <form class="my-5" method="post" v-show="registration.isShow">
                        <div class="form-group">
                            <label class="form-label">Почта</label>
                            <input type="text" class="form-control" v-model="email" tabindex="1"
                                   v-bind:class="isValidEmail ? '' : 'is-invalid'">
                            <small class="invalid-feedback">Пожалуйста, введите корректный адрес электронной почты.</small>
                        </div>
                        <div class="form-group">
                            <label class="form-label d-flex justify-content-between align-items-end">
                                <div>Пароль</div>
                                <a href="javascript:void(0)" class="d-block small" v-on:click="changeView(login.id, recoveryPassword.id)">Забыли пароль?</a>
                            </label>
                            <div class="input-group">
                                <input type="password" class="form-control" v-model="password" tabindex="2" name="password"
                                       v-bind:class="isValidPassword ? '' : 'is-invalid'">
                                <span class="input-group-append">
                                    <button class="btn btn-outline-secondary" type="button" title="Показать пароль" style="border-radius: 0px 4px 4px 0px;"
                                            v-on:click="isHiddenPassword = !isHiddenPassword">
                                        <i class="fas fa-eye" v-show="isHiddenPassword"></i>
                                        <i class="fas fa-eye-slash" v-show="isHiddenPassword == false"></i>
                                    </button>
                                </span>
                                <small class="form-text text-muted">
                                    Пароль должен содержать больше 5 символов
                                </small>
                                <small class="invalid-feedback">Пожалуйста, введите корректный пароль.</small>
                            </div>
                        </div>
                        <button type="button" class="btn btn-primary btn-block mt-4"
                                v-bind:disabled="isSaving"
                                v-on:click="onRegistration">
                            <span class="spinner-border" role="status" aria-hidden="true" v-show="isSaving"></span>
                            Зарегистрироваться
                        </button>
                        <div class="text-center text-muted mt-4">
                            Если у вас уже есть аккаунт <a href="javascript:void(0)" v-on:click="changeView(registration.id,login.id)">Авторизоваться</a>
                        </div>
                    </form>
                    <!-- / registration -->
                    <!-- recoveryPassword -->
                    <form class="my-5" v-show="recoveryPassword.isShow">
                        <p>
                            Введите ваш email и мы вышлем вам на почту письмо с кодом
                        </p>
                        <div class="form-group">
                            <input type="text" class="form-control" v-model="email" tabindex="1"
                                   v-bind:class="isValidEmail ? '' : 'is-invalid'">
                            <small class="invalid-feedback">Пожалуйста, введите корректный адрес электронной почты.</small>
                        </div>
                        <button type="button" class="btn btn-primary btn-block mt-4"
                                v-bind:disabled="isSaving"
                                v-on:click="onRecoveryPassword">
                            <span class="spinner-border" role="status" aria-hidden="true" v-show="isSaving"></span>
                            Отправить письмо
                        </button>
                        <div class="text-center text-muted mt-4">
                            Если у вас уже есть аккаунт <a href="javascript:void(0)" v-on:click="changeView(recoveryPassword.id, login.id)">Авторизоваться</a>
                            или если нет аккаунта <a href="javascript:void(0)" v-on:click="changeView(recoveryPassword.id, registration.id)">Зарегистрироваться</a>
                        </div>
                    </form>
                    <!-- / recoveryPassword -->
                    <!-- recoveryPassword2 -->
                    <form class="my-5" method="post" v-show="recoveryPassword2.isShow">
                        <p>
                            Введите новый пароль
                        </p>

                        <div class="form-group">
                            <div class="input-group">
                                <input type="password" class="form-control" v-model="password" tabindex="2" name="password"
                                       v-bind:class="isValidPassword ? '' : 'is-invalid'">
                                <span class="input-group-append">
                                    <button class="btn btn-outline-secondary" type="button" title="Показать пароль" style="border-radius: 0px 4px 4px 0px;"
                                            v-on:click="isHiddenPassword = !isHiddenPassword">
                                        <i class="fas fa-eye" v-show="isHiddenPassword"></i>
                                        <i class="fas fa-eye-slash" v-show="isHiddenPassword == false"></i>
                                    </button>
                                </span>
                                <small class="form-text text-muted">
                                    Пароль должен содержать больше 5 символов
                                </small>
                                <small class="invalid-feedback">Пожалуйста, введите корректный пароль.</small>
                            </div>
                        </div>
                        <button type="button" class="btn btn-primary btn-block mt-4"
                                v-bind:disabled="isSaving"
                                v-on:click="onSetNewPassword">
                            <span class="spinner-border" role="status" aria-hidden="true" v-show="isSaving"></span>
                            Обновть пароль
                        </button>
                        <div class="text-center text-muted mt-4">
                            Если у вас уже есть аккаунт <a href="javascript:void(0)" v-on:click="changeView(recoveryPassword2.id, login.id)">Авторизоваться</a>
                            или если нет аккаунта <a href="javascript:void(0)" v-on:click="changeView(recoveryPassword2.id, registration.id)">Зарегистрироваться</a>
                        </div>
                    </form>
                    <!-- / recoveryPassword -->
                    <!-- enterCode -->
                    <form class="my-5" method="post" v-show="enterCode.isShow">
                        <p>
                            Вам на почту было отправлено письмо. Пожалуйста введите код из письма.
                        </p>
                        <div class="form-group">
                            <div class="input-group">
                                <input type="number" class="form-control" min="" max="9999" maxlength="4"
                                       v-model="enterCode.code"
                                       v-bind:class="isValidCode ? '' : 'is-invalid'">
                                <span class="input-group-append">
                                    <button class="btn btn-outline-secondary" type="button" title="Отправить повторно" style="border-radius: 0px 4px 4px 0px;"
                                            v-on:click="resend"
                                            v-bind:disabled="enterCode.canResend == false">
                                        <i class="fas fa-undo "></i>
                                    </button>
                                </span>
                                <small class="invalid-feedback">Пожалуйста, введите корректный 4-х значный код.</small>
                            </div>
                            <small class="form-text text-muted" v-show="enterCode.canResend == false">
                                {{ enterCode.canResend ? '' : 'Отправить код повторно через : '+ enterCode.seconds}}
                            </small>
                        </div>
                        <button class="btn btn-primary btn-block" type="button" tabindex="3"
                                v-bind:disabled="isSaving"
                                v-on:click="checkCode">
                            <span class="spinner-border" role="status" aria-hidden="true" v-show="isSaving"></span>
                            Проверить
                        </button>
                        <div class="text-center text-muted mt-4">
                            Если у вас уже есть аккаунт <a href="javascript:void(0)" v-on:click="changeView(login.id)">Авторизоваться</a>
                            или если нет аккаунта <a href="javascript:void(0)" v-on:click="changeView(registration.id)">Зарегистрироваться</a>
                        </div>
                    </form>
                    <!-- / enterCode -->
                    @*@if (Model.IsOk == true)
                        {
                        }
                        else if (Model.IsOk == false)
                        {
                            <div class="alert alert-danger mt-3">
                                @Model.Message
                            </div>
                        }*@
                    <div class="alert alert-success mt-3 alert-dismissible" v-show="textMessage">
                        <button type="button" class="close" data-dismiss="alert" v-on:click="textMessage = null">×</button>
                        {{ textMessage }}
                    </div>
                    <div class="alert alert-danger mt-3 alert-dismissible" v-show="textError">
                        <button type="button" class="close" data-dismiss="alert" v-on:click="textError = null">×</button>
                        {{ textError }}
                    </div>

                </div>
            </div>
        </div>
        <!-- / Form container -->

    </div>
</div>