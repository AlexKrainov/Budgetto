Vue.component("vue-section-component",{template:`
        <div v-bind:id="dataId" >
            <input type='search'
                    name="sectionSearch"
                    v-model="searchText"
                    class="form-control form-control-sm mb-1"
                    v-on:input="onsearch" 
                    v-show="isShowFilter"/>
            <div class="cards" v-bind:style="searchText ? '' : dataRecordsStyle"
                v-bind:class="dataClass">
                <div class="card-section card"
                     v-for="(section, index) in sections"
                     v-bind:key="section.id"
                     v-on:click="onSelect(section)"
                     v-bind:title="section.description"
                     v-show="section.isShow"
                     v-bind:style="'color: '+ section.cssColor +';background-color: '+ section.cssBackground"
                     v-bind:class="[section.isSelected  ? 'selected-section' : 'not-selected-section', dataSectionClasses ]">
                    <span class="selected-section-count">{{ checkCountSelected(section) }}</span>
                    <div class="cards-container card-body d-flex align-items-center ">
                        <i class="icon-large opacity-75" v-bind:class="section.cssIcon"></i>
                        <div class="card-section-text ml-2">
                            <div class="section-name">{{section.name}}</div>
                            <div class="area-name opacity-75" style="margin-top: -5px;">
                                {{ section.areaName }}
                                <div class="ml-2" style="display: inline-block;" 
                                    v-show="section.collectiveSections && section.collectiveSections.length > 0">
                                    <i class="oi oi-layers"></i> +{{ section.collectiveSections ? section.collectiveSections.length : "0"}}
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <button type="button" class="btn btn-default card-section text-big" style="box-shadow: none;" 
                    v-show="privateIsHideMoreThenOneSections && sections.length > 2"
                    v-on:click="showAllSections">+{{ sections.length - 1 }}</button>
            </div>
        </div>`,props:{dataSearchId:String,dataId:String,name:{type:String,"default":"section-component"},onchoose:Event,onUpdateView:Event,isShowFilter:{type:Boolean,"default":!1},dataItems:Array,dataRecordsStyle:{type:String,"default":""},dataClass:{type:String,"default":"cards-small"},dataSelectedItemsCount:Array,dataIsSelection:{type:Boolean,"default":!1},dataSectionClasses:{type:String,"default":"cursor-pointer"},isHideMoreThenOneSections:{type:Boolean,"default":!1}},data:function(){return{count:0,sections:[],searchText:null,privateIsHideMoreThenOneSections:!1}},watch:{dataItems:function(){this.updateSections()}},mounted:function(){this.privateIsHideMoreThenOneSections=this.isHideMoreThenOneSections;new PerfectScrollbar(document.getElementsByClassName("cards")[0]);this.dataItems==undefined?this.load():this.updateSections()},methods:{load:function(){return $.ajax({type:"GET",url:"/Section/GetSectins",data:null,contentType:"application/json; charset=utf-8",dataType:"json",context:this,success:function(n){return n.isOk&&(this.sections=n.sections),n},error:function(n,t,i){console.log(i)}},this)},onsearch:function(n){let i=n.target.value.toLocaleLowerCase();for(var t=0;t<this.sections.length;t++)this.sections[t].isShow=this.sections[t].name.toLocaleLowerCase().indexOf(i)>=0},updateSections:function(n){if(this.sections=n?n:this.dataItems,this.privateIsHideMoreThenOneSections)for(var t=1;t<this.sections.length;t++)this.sections[t].isShow=!1;this.$forceUpdate()},checkCountSelected:function(n){if(this.dataSelectedItemsCount&&this.dataSelectedItemsCount.length>0){let t=this.dataSelectedItemsCount.filter(t=>t.id==n.id);if(t&&t.length>0)return t[0].count}return""},clearSearchTextValue:function(){this.searchText=null;for(var n=0;n<this.sections.length;n++)this.sections[n].isShow=!0},onSelect:function(n){this.dataIsSelection&&(n.isSelected=!n.isSelected);this.$emit("onchoose",n)},selectAllSections:function(){for(var n=0;n<this.sections.length;n++)if(this.sections[n].isSelected==!1)this.onSelect(this.sections[n])},showAllSections:function(){this.privateIsHideMoreThenOneSections=!1;for(var n=1;n<this.sections.length;n++)this.sections[n].isShow=!0;this.$emit("on-update-view",!0)}}});