var ReminderVue=new Vue({el:"#reminder-vue",data:{reminders:[],reminder:{isRepeat:!1},dateTime:null,flatpickrReminder:{},searchText:null,isSaving:!1,isShowModal:!1,isNew:!0},watch:{},mounted:function(){},methods:{showReminders:function(n){return this.dateTime=n,this.close(),this.loadTimeLine(n)},addReminders:function(n){return this.dateTime=n,this.edit(),this.loadTimeLine(n)},loadTimeLine:function(n){return $.ajax({type:"GET",url:"/Reminder/LoadReminders?currentDate="+n,contentType:"application/json",dataType:"json",context:this,success:function(n){this.reminders=n.data;$("#modalReminderTimeLine").modal("show")}})},chooseReminderIcon:function(n){if($(".reminder-icons i").removeClass("active"),!n)return!0;let t=n.replace(" ",".");$(".reminder-icons i."+t).addClass("active");this.reminder.cssIcon=n},closeTimeline:function(){this.clearAllStyle()},GetDateByFormat:function(n,t){return GetDateByFormat(n,t)},edit:function(n){if(this.isShowModal=!0,this.reminder.id=-1,this.reminder.title=null,this.reminder.description=null,this.reminder.cssIcon=null,this.reminder.isRepeat=!1,this.reminder.repeatEvery=null,n){this.isNew=!1;this.reminder=JSCopyObject(n);let t=GetFlatpickrRuConfig(this.reminder.dateReminder);this.flatpickrReminder=flatpickr("#reminderDateReminder",t)}else{this.isNew=!0;this.reminder.dateReminder=this.dateTime;let n=GetFlatpickrRuConfig(this.dateTime);this.flatpickrReminder=flatpickr("#reminderDateReminder",n)}this.chooseReminderIcon(this.reminder.cssIcon)},close:function(){this.isShowModal=!1;this.reminder={isRepeat:!1};this.chooseReminderIcon()},save:function(){return this.checkValid()==!1?!1:(this.isSaving=!0,$.ajax({type:"POST",url:"/Reminder/Edit",data:JSON.stringify(this.reminder),context:this,contentType:"application/json",dataType:"json",success:function(n){if(n.isOk){let t=this.reminders.findIndex(t=>t.id==n.data.id);t==-1?this.reminders.push(n.data):this.reminders[t]=n.data;BudgetVue.refresh("onlyTable");this.close()}this.isSaving=!1},error:function(){this.isSaving=!1}}))},checkValid:function(){let n=!0;$("#reminderTitle, #reminderDateReminder").removeClass("is-invalid");this.reminder.title&&this.reminder.title.length>0||(n=!1,$("#reminderTitle").addClass("is-invalid"));let t=this.reminder.title;return t=t?t.replaceAll(" ",""):"",t.length==0?(n=!1,$("#reminderTitle").addClass("is-invalid")):$("#reminderTitle").removeClass("is-invalid"),this.reminder.cssIcon&&this.reminder.cssIcon.length>0?$("#reminderIcons").css("display","none"):(n=!1,$("#reminderIcons").css("display","block")),this.reminder.dateReminder&&this.reminder.dateReminder.length>0||(n=!1,$("#reminderDateReminder").addClass("is-invalid")),n},remove:function(n){return ShowLoading("#reminder_"+n.id),$.ajax({type:"POST",url:"/Reminder/Remove",data:JSON.stringify(n),context:n,contentType:"application/json",dataType:"json",success:function(t){n.isDeleted=t.isDeleted;HideLoading("#reminder_"+n.id);BudgetVue.refresh("onlyTable")}})},recovery:function(n){return ShowLoading("#reminder_"+n.id),$.ajax({type:"POST",url:"/Reminder/Recovery",data:JSON.stringify(n),context:n,contentType:"application/json",dataType:"json",success:function(t){n.isDeleted=!t.isRecovery;HideLoading("#reminder_"+n.id);BudgetVue.refresh("onlyTable")}})},textRepeat:function(n){switch(n){case"Day":return"День";case"Week":return"Неделя";case"Month":return"Месяц";case"Year":return"Год";default:return""}}}});