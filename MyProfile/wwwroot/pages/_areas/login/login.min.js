var LoginVue=new Vue({el:"#login-vue",data:{email:null,password:null,userSessionID:null,isHiddenPassword:!0,isValidEmail:!0,isValidPassword:!0,isValidCode:!0,textError:null,textMessage:null,login:{id:0,isShow:!0},registration:{id:1,isShow:!1},recoveryPassword:{id:2,isShow:!1},recoveryPassword2:{id:4,isShow:!1,userID:null},enterCode:{id:3,isShow:!1,code:null,canResend:!1,seconds:60,lastActionID:0},isSaving:!1,person_data:{ip:"",city:"",country:"",location:"",index:"",browser_name:"",browser_version:"",os_name:"",os_version:"",screen_size:"",referrer:"",isMobile:!1,isLoad:!1,isShow:!1,path:"",dateCreate:null,continent_code:"",continent_name:"",info:""},title:"",titles:["Знаешь, сколько тратишь в месяц?","Знаешь, сколько смог бы сэкономить на фастфуде?","Знаешь, сколько тратишь на машину в год?","Знаешь, сколько тратишь на одежду?","Учёт бюджета с помощью таблиц"],titleID:0},computed:{emailValid:function(){return this.email&&this.email.indexOf("@")>0&&this.email.indexOf(".")>0}},watch:{isHiddenPassword:function(n){n?$("input[name=password]").prop("type","password"):$("input[name=password]").prop("type","text")}},mounted:function(){if($(".tlt").textillate({loop:!0,minDisplayTime:3e3,initialDelay:500,autoStart:!0,"in":{effect:"fadeInLeftBig",delayScale:1.5,delay:25},out:{effect:"fadeOutRightBig",delayScale:1.5,delay:25,callback:function(){}},type:"word"}),this.userSessionID=UserSessionID,this.person_data.userSessionID=this.userSessionID,this.person_data.referrer=document.referrer,Email&&(this.email=Email),LoginView!=null?(this.recoveryPassword2.userID=LoginView.UserID,this.changeView(2,LoginView.ID)):this.changeView(this.login.id),!UserSessionID||!document.location.href.includes("id=")||!(document.location.href.includes("isLandingPage=true")||document.location.href.includes("isRecoveryPassword=true"))){if(ip=="::1")return this.person_data={userSessionID:this.userSessionID,ip:"Local",city:"Moscow",country:"Russia",location:"55.7522, 37.6156",index:"111111",browser_name:"Chrome",browser_version:85,os_name:"Windows",os_version:"10",screen_size:"1536 x 864",referrer:"",isMobile:!1,isLoad:!1,isShow:!1,path:"/Identity/Account/Login",dateCreate:null,continent_code:"EU",continent_name:"Europe",info:"",provider_info:'{"asn":"AS8402","name":"PJSC \\"Vimpelcom\\"","domain":"veon.com","route":"37.144.0.0/14","type":"isp"}',threat:'{"is_tor":false,"is_proxy":false,"is_anonymous":false,"is_known_attacker":false,"is_known_abuser":false,"is_threat":false,"is_bogon":false}'},$.ajax({type:"POST",url:"/Identity/Account/Stat",context:LoginVue,data:JSON.stringify(this.person_data),contentType:"application/json; charset=utf-8",dataType:"json",success:function(n){return LoginVue.userSessionID=n.userSessionID,n},error:function(n,t,i){console.log(i)}});try{$.get(`https://api.ipdata.co/${ip}?api-key=65b72cf7f83e7582fd54e2c3fad07548678dfa6e363424eb773edbd5`,function(n){LoginVue.person_data.userSessionID=LoginVue.userSessionID;LoginVue.person_data.ip=n.ip;LoginVue.person_data.city=n.city;LoginVue.person_data.country=n.country_name;LoginVue.person_data.continent_code=n.continent_code;LoginVue.person_data.continent_name=n.continent_name;LoginVue.person_data.location=n.latitude+", "+n.longitude;LoginVue.person_data.index=n.postal;LoginVue.person_data.provider_info=JSON.stringify(n.asn);LoginVue.person_data.current_user_time=n.current_time;LoginVue.person_data.threat=JSON.stringify(n.threat);LoginVue.get_browser_info();let t=window.jscd;return LoginVue.person_data.browser_name=t.browser,LoginVue.person_data.browser_version=t.browserMajorVersion,LoginVue.person_data.os_name=t.os,LoginVue.person_data.os_version=t.osVersion,LoginVue.person_data.isMobile=t.mobile,LoginVue.person_data.screen_size=t.screen,LoginVue.person_data.referrer=document.referrer,LoginVue.person_data.path=document.location.pathname,LoginVue.person_data}).then(function(){return $.ajax({type:"POST",url:"/Identity/Account/Stat",context:LoginVue,data:JSON.stringify(LoginVue.person_data),contentType:"application/json; charset=utf-8",dataType:"json",success:function(n){return LoginVue.userSessionID=n.userSessionID,n},error:function(n,t,i){this.isSaving=!1;console.log(i)}})})}catch(n){return $.ajax({type:"POST",url:"/Identity/Account/Stat",context:LoginVue,data:JSON.stringify(this.person_data),contentType:"application/json; charset=utf-8",dataType:"json",success:function(n){return LoginVue.userSessionID=n.userSessionID,n},error:function(n,t,i){this.isSaving=!1;console.log(i)}})}}},methods:{loginSave:function(){return this.checkForm()==!1?!1:(this.isSaving=!0,$.ajax({type:"POST",url:"/Identity/Account/Login",context:this,data:JSON.stringify({email:this.email,password:this.password,userSessionID:this.userSessionID}),contentType:"application/json; charset=utf-8",dataType:"json",success:function(n){return n.isOk==!1?(this.textError=n.textError,this.isSaving=!1):n.emailID?(this.enterCode.emailID=n.emailID,this.changeView(this.login.id,this.enterCode.id),this.isSaving=!1):n.href&&(document.location.href=n.href),n},error:function(n,t,i){this.isSaving=!1;this.textError="Ошибка авторизации. Пожалуйста, попробуйте еще раз.";console.log(i)}}))},checkForm:function(n){let t=!0;return this.isValidPassword=this.validPassword(),t=this.isValidPassword,this.isValidEmail=this.emailValid,this.isValidEmail||(t=!1),t==!1&&n&&n.preventDefault(),t},validPassword:function(){let n=!0;return this.password==null||this.password==""?(n=!1,this.textError="Пароль не может быть пустым.",n):(this.textError=null,this.password.length<5)?(n=!1,this.textError="Пароль должен содержать не менее 5 символов.",n):(this.textError=null,this.password.indexOf(" ")>=0?(n=!1,this.textError="Пароль не должен содержать пробелов."):this.textError=null,n)},onRegistration:function(){return this.checkForm()==!1?!1:(this.textError=null,this.isSaving=!0,$.ajax({type:"POST",url:"/Identity/Account/Registration",context:this,data:JSON.stringify({email:this.email,password:this.password,userSessionID:this.userSessionID}),contentType:"application/json; charset=utf-8",dataType:"json",success:function(n){return n.isOk==!1?(this.textError=n.message,this.isSaving=!1):n.isShowCode?(this.enterCode.emailID=n.emailID,this.changeView(this.registration.id,this.enterCode.id),this.isSaving=!1):document.location.href=n.href,n},error:function(n,t,i){this.isSaving=!1;console.log(i)}}))},onRecoveryPassword:function(){return this.emailValid==!1?(this.isValidEmail=!1,!1):(this.isValidEmail=!0,this.textError=null,this.isSaving=!0,$.ajax({type:"POST",url:"/Identity/Account/RecoveryPassword",context:this,data:JSON.stringify({email:this.email,userSessionID:this.userSessionID}),contentType:"application/json; charset=utf-8",dataType:"json",success:function(n){return n.isOk==!1?this.textError=n.message:(this.enterCode.emailID=n.emailID,this.changeView(this.recoveryPassword.id,this.enterCode.id)),this.isSaving=!1,n},error:function(n,t,i){this.isSaving=!1;console.log(i)}}))},onSetNewPassword:function(){return this.validPassword()==!1?(this.isValidPassword=!1,!1):(this.isValidPassword=!0,this.isSaving=!0,$.ajax({type:"POST",url:"/Identity/Account/RecoveryPassword2",context:this,data:JSON.stringify({id:this.recoveryPassword2.userID,newPassword:this.password,userSessionID:this.userSessionID}),contentType:"application/json; charset=utf-8",dataType:"json",success:function(n){return n.isOk==!1?(this.textError=n.message,this.isSaving=!1):document.location.href=n.href,n},error:function(n,t,i){this.isSaving=!1;console.log(i)}}))},checkCode:function(){return(this.enterCode.emailID&&this.enterCode.code&&this.enterCode.code.length==4)?(this.isValidCode=!0,this.textError=null,this.isSaving=!0,this.enterCode.userSessionID=this.userSessionID,$.ajax({type:"POST",url:"/Identity/Account/CheckCode",context:this,data:JSON.stringify(this.enterCode),contentType:"application/json; charset=utf-8",dataType:"json",success:function(n){return n.isOk==!1?(this.textError=n.message,this.isSaving=!1):n.canChangePassword?(this.recoveryPassword2.userID=n.userID,this.changeView(this.checkCode.id,this.recoveryPassword2.id),this.isSaving=!1):document.location.href=n.href,n},error:function(n,t,i){this.isSaving=!1;console.log(i)}})):(this.isValidCode=!1,!1)},changeView:function(n,t){this.isValidEmail=!0;this.isValidPassword=!0;this.isValidCode=!0;this.textError=null;this.textMessage=null;switch(t){case this.login.id:this.login.isShow=!0;this.registration.isShow=!1;this.recoveryPassword.isShow=!1;this.enterCode.isShow=!1;this.recoveryPassword2.isShow=!1;break;case this.registration.id:this.login.isShow=!1;this.registration.isShow=!0;this.recoveryPassword.isShow=!1;this.recoveryPassword2.isShow=!1;this.enterCode.isShow=!1;break;case this.recoveryPassword.id:this.login.isShow=!1;this.registration.isShow=!1;this.recoveryPassword.isShow=!0;this.recoveryPassword2.isShow=!1;this.enterCode.isShow=!1;break;case this.enterCode.id:this.enterCode.lastActionID=n;this.login.isShow=!1;this.registration.isShow=!1;this.recoveryPassword.isShow=!1;this.recoveryPassword2.isShow=!1;this.enterCode.isShow=!0;this.showResendCodeButton();break;case this.recoveryPassword2.id:this.login.isShow=!1;this.registration.isShow=!1;this.recoveryPassword.isShow=!1;this.recoveryPassword2.isShow=!0;this.enterCode.isShow=!1}},showResendCodeButton:function(){LoginVue.enterCode.canResend=!1;var n=60,t=setInterval(function(){n<=0?(clearInterval(t),LoginVue.enterCode.seconds=n,LoginVue.enterCode.canResend=!0):LoginVue.enterCode.seconds=n;n-=1},1e3)},resend:function(){return this.enterCode.emailID?this.enterCode.seconds>0?!1:(this.checkCode.code=null,this.textError=null,this.textMessage=null,this.isSaving=!0,this.enterCode.userSessionID=this.userSessionID,$.ajax({type:"POST",url:"/Identity/Account/Resend",context:this,data:JSON.stringify(this.enterCode),contentType:"application/json; charset=utf-8",dataType:"json",success:function(n){return n.isOk==!1?(this.textError=n.message,document.location.href=n.href):(this.enterCode.emailID=n.emailID,this.showResendCodeButton(),this.isSaving=!1),n},error:function(n,t,i){this.isSaving=!1;console.log(i)}})):!1},kaypress:function(n){n.keyCode==13&&(n.preventDefault(),this.login.isShow?$("#login-btn").click():this.registration.isShow?$("#registraion-btn").click():this.recoveryPassword.isShow?this.onRecoveryPassword():this.recoveryPassword2.isShow?$("#recovery2-btn").click():this.enterCode.isShow&&$("#checkCode-btn").click())},get_browser_info:function(){var c="-",y="",b,h,f,l,k,a,u,v,o;screen.width&&(width=screen.width?screen.width:"",height=screen.height?screen.height:"",y+=""+width+" x "+height);var p=navigator.appVersion,n=navigator.userAgent,r=navigator.appName,t=""+parseFloat(navigator.appVersion),s=parseInt(navigator.appVersion,10),w,i,e;(i=n.indexOf("Opera"))!=-1&&(r="Opera",t=n.substring(i+6),(i=n.indexOf("Version"))!=-1&&(t=n.substring(i+8)));(i=n.indexOf("OPR"))!=-1?(r="Opera",t=n.substring(i+4)):(i=n.indexOf("Edge"))!=-1?(r="Microsoft Edge",t=n.substring(i+5)):(i=n.indexOf("MSIE"))!=-1?(r="Microsoft Internet Explorer",t=n.substring(i+5)):(i=n.indexOf("Chrome"))!=-1?(r="Chrome",t=n.substring(i+7)):(i=n.indexOf("Safari"))!=-1?(r="Safari",t=n.substring(i+7),(i=n.indexOf("Version"))!=-1&&(t=n.substring(i+8))):(i=n.indexOf("Firefox"))!=-1?(r="Firefox",t=n.substring(i+8)):n.indexOf("Trident/")!=-1?(r="Microsoft Internet Explorer",t=n.substring(n.indexOf("rv:")+3)):(w=n.lastIndexOf(" ")+1)<(i=n.lastIndexOf("/"))&&(r=n.substring(w,i),t=n.substring(i+1),r.toLowerCase()==r.toUpperCase()&&(r=navigator.appName));(e=t.indexOf(";"))!=-1&&(t=t.substring(0,e));(e=t.indexOf(" "))!=-1&&(t=t.substring(0,e));(e=t.indexOf(")"))!=-1&&(t=t.substring(0,e));s=parseInt(""+t,10);isNaN(s)&&(t=""+parseFloat(navigator.appVersion),s=parseInt(navigator.appVersion,10));b=/Mobile|mini|Fennec|Android|iP(ad|od|hone)/.test(p);h=navigator.cookieEnabled?!0:!1;typeof navigator.cookieEnabled!="undefined"||h||(document.cookie="testcookie",h=document.cookie.indexOf("testcookie")!=-1?!0:!1);f=c;l=[{s:"Windows 10",r:/(Windows 10.0|Windows NT 10.0)/},{s:"Windows 8.1",r:/(Windows 8.1|Windows NT 6.3)/},{s:"Windows 8",r:/(Windows 8|Windows NT 6.2)/},{s:"Windows 7",r:/(Windows 7|Windows NT 6.1)/},{s:"Windows Vista",r:/Windows NT 6.0/},{s:"Windows Server 2003",r:/Windows NT 5.2/},{s:"Windows XP",r:/(Windows NT 5.1|Windows XP)/},{s:"Windows 2000",r:/(Windows NT 5.0|Windows 2000)/},{s:"Windows ME",r:/(Win 9x 4.90|Windows ME)/},{s:"Windows 98",r:/(Windows 98|Win98)/},{s:"Windows 95",r:/(Windows 95|Win95|Windows_95)/},{s:"Windows NT 4.0",r:/(Windows NT 4.0|WinNT4.0|WinNT|Windows NT)/},{s:"Windows CE",r:/Windows CE/},{s:"Windows 3.11",r:/Win16/},{s:"Android",r:/Android/},{s:"Open BSD",r:/OpenBSD/},{s:"Sun OS",r:/SunOS/},{s:"Linux",r:/(Linux|X11)/},{s:"iOS",r:/(iPhone|iPad|iPod)/},{s:"Mac OS X",r:/Mac OS X/},{s:"Mac OS",r:/(MacPPC|MacIntel|Mac_PowerPC|Macintosh)/},{s:"QNX",r:/QNX/},{s:"UNIX",r:/UNIX/},{s:"BeOS",r:/BeOS/},{s:"OS/2",r:/OS\/2/},{s:"Search Bot",r:/(nuhk|Googlebot|Yammybot|Openbot|Slurp|MSNBot|Ask Jeeves\/Teoma|ia_archiver)/}];for(k in l)if(a=l[k],a.r.test(n)){f=a.s;break}u=c;/Windows/.test(f)&&(u=/Windows (.*)/.exec(f)[1],f="Windows");switch(f){case"Mac OS X":u=/Mac OS X (10[\.\_\d]+)/.exec(n)[1];break;case"Android":u=/Android ([\.\_\d]+)/.exec(n)[1];break;case"iOS":u=/OS (\d+)_(\d+)_?(\d+)?/.exec(p);u=u[1]+"."+u[2]+"."+(u[3]|0)}v="no check";typeof swfobject!="undefined"&&(o=swfobject.getFlashPlayerVersion(),v=o.major>0?o.major+"."+o.minor+" r"+o.release:c);window.jscd={screen:y,browser:r,browserVersion:t,browserMajorVersion:s,mobile:b,os:f,osVersion:u,cookies:h,flashVersion:v}}}});