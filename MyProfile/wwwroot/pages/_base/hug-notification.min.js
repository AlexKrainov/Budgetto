if(document.location.href.indexOf("Start/Index")==-1)var NotificationVue=new Vue({el:"#notification-vue",data:{notifications:[],anyNew:!1,isEndLoadNotification:!1,hubConnection:null,isSaving:!1},computed:{},mounted:function(){this.hubConnection=(new signalR.HubConnectionBuilder).withUrl("/NotificationHub").configureLogging(signalR.LogLevel.Information).build();this.hubConnection.start().catch(function(n){return console.error(n.toString())});Object.defineProperty(WebSocket,"OPEN",{value:1});this.hubConnection.on("Receive",this.receive);setTimeout(this.load.bind(this,10),3100)},methods:{load:function(n){return this.isSaving=!0,$.ajax({type:"GET",url:"/Notification/GetLast?skip="+this.notifications.length+"&take="+n,contentType:"application/json",dataType:"json",context:this,success:function(n){n.isOk==!0&&(this.isEndLoadNotification=n.notifications.length==0,this.notifications=this.notifications.concat(n.notifications),this.anyNew=this.notifications.some(n=>n.isRead==!1),this.isSaving=!1)},error:function(n){console.log(n);this.isSaving=!1}})},openNotification:function(){if(this.notifications.some(n=>n.isRead==!1)){let n=this.notifications.map(n=>n.notificationID);return $.ajax({type:"POST",url:"/Notification/SetFlagRead",contentType:"application/json",dataType:"json",data:JSON.stringify(n),context:this,success:function(n){n.isOk==!0&&(this.anyNew=!1,setTimeout(function(){for(var n=0;n<NotificationVue.notifications.length;n++)NotificationVue.notifications[n].isRead=!0},2e3))},error:function(n){console.log(n)}})}this.anyNew=!1},receive:function(n){n.notifyType=="warning"?toastr.warning(n.message,n.title):n.notifyType=="success"&&toastr.success(n.message,n.title);this.anyNew=!0;let t=this.notifications.findIndex(t=>t.notificationID==n.notificationID);t>=0&&this.notifications.splice(t,1);this.notifications.unshift(n)},getDateByFormat:function(n,t){return GetDateByFormat(n,t)}}});