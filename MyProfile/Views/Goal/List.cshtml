@{
	ViewData["Title"] = "Project list - Pages";
}

@section Styles {
}

@section Scripts {
	<script src="~/app_js/goal-list.js"></script>
	<script src="~/app_js/goal-edit.js"></script>
}
<h4 class="d-flex justify-content-between align-items-center w-100 font-weight-bold py-3 mb-4">
	<span>Цели</span>
	<button type="button" class="btn btn-primary rounded-pill d-block" onclick="GoalEditVue.edit()"><span class="ion ion-md-add"></span>&nbsp; Добавить цель</button>
</h4>

<div class="row" id="goal-list-vue">
	<div class="col-sm-6 col-xl-4" v-for="goal in goals">

		<div class="card mb-4">
			<div class="card-body pb-0">
				<div class="d-flex justify-content-between align-items-start">
					<div>
						<a href="javascript:void(0)" class="text-body text-big font-weight-semibold">{{ goal.name }}</a>
						<span class="badge badge-warning align-text-bottom ml-1" v-show="!goal.isFinished">В процессе</span>
						<span class="badge badge-success align-text-bottom ml-1" v-show="goal.isFinished">Закончен</span>
						@if (MyProfile.Identity.UserInfo.Current.IsAllowCollectiveBudget)
						{
							<div class="text-muted small mb-1" v-show="!goal.isShowInCollective">Видите только вы</div>
							<div class="text-muted small mb-1" v-show="goal.isShowInCollective">Видят все</div>
						}
					</div>
					<div class="btn-group team-actions">
						<button type="button" class="btn btn-sm btn-default icon-btn borderless rounded-pill md-btn-flat dropdown-toggle hide-arrow" data-toggle="dropdown">
							<i class="ion ion-ios-more"></i>
						</button>
						<div class="dropdown-menu dropdown-menu-right">
							<a class="dropdown-item" href="javascript:void(0)" v-on:click="addMoney(goal.id)">Добавить деньги</a>
							<a class="dropdown-item" href="javascript:void(0)" v-on:click="edit(goal)">Редактировать</a>
							<a class="dropdown-item" href="javascript:void(0)">Remove</a>
						</div>
					</div>
				</div>
				<div class="mt-3">
					{{ goal.description }}
				</div>
			</div>
			<div class="card-body py-3">
				@*<div class="text-muted small mb-2">Кто участвует</div>
					<div class="d-flex flex-wrap">
							<a href="javascript:void(0)" class="d-block mr-1 mb-1"><img src="~/img/avatars/3-small.png" alt="" class="ui-w-30 rounded-circle"></a>
							<a href="javascript:void(0)" class="d-block mr-1 mb-1"><img src="~/img/avatars/6-small.png" alt="" class="ui-w-30 rounded-circle"></a>
						</div>*@
			</div>
			<hr class="m-0">
			<div class="card-body">
				<div class="d-flex justify-content-between align-items-center small">
					<div class="font-weight-bold">{{ goal.percent }}%</div>
					<div class="text-muted">{{ new Intl.NumberFormat('ru-RU', { style: 'currency', currency: 'RUB' }).format(goal.totalMoney) }} / {{ new Intl.NumberFormat('ru-RU', { style: 'currency', currency: 'RUB' }).format(goal.expectationMoney) }} </div>
				</div>
				<div class="progress mt-1" style="height: 3px;">
					<div class="progress-bar" v-bind:style="'width: '+ goal.percent +'%;'"></div>
				</div>
				<div class="row mt-3">
					<div class="col">
						<div class="text-muted small">Начало </div>
						<div class="small font-weight-bold">{{  getDateByFormat(goal.dateStart, 'DD.MM.YYYY') }}</div>
					</div>
					<div class="col">
						<div class="text-muted small">Окончание</div>
						<div class="small font-weight-bold">{{  getDateByFormat(goal.dateEnd, 'DD.MM.YYYY') }}</div>
					</div>
				</div>
			</div>
		</div>
	</div>
</div>
@await Html.PartialAsync("_EditGoal")


@await Html.PartialAsync(@"../Settings/Settings.cshtml", "Goal/List")